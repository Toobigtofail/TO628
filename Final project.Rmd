---
title: "TO 628 Final Project: Speed Dating Business Challenge"
author: "Too Big to Fail: David Chang, Lu Feng, and Tarun Sairam"
date: "April 11, 2017"
output: 
  html_document: 
    highlight: tango
    toc: yes
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#Introduction
[Enter narrative about goals, business problem, what we intended to solve and general outline for the project]


#Data cleaning
```{r}
#attach relevant libraries for project
suppressPackageStartupMessages(require(plyr))
suppressPackageStartupMessages(require(dplyr))
suppressPackageStartupMessages(require(class))
suppressPackageStartupMessages(require(gmodels))
suppressPackageStartupMessages(require(stats))
suppressPackageStartupMessages(require(party))
suppressPackageStartupMessages(require(magrittr))
suppressPackageStartupMessages(require(beepr))
suppressPackageStartupMessages(require(caret))
suppressPackageStartupMessages(library(kernlab))
suppressPackageStartupMessages(library(neuralnet))
suppressPackageStartupMessages(library(randomForest))
suppressPackageStartupMessages(library(ada))
```


```{r}
#upload and clean data
speed <- read.csv("Speed Dating Data.csv")
speed$gender <- factor(x =speed$gender, levels = c(0,1), labels = c("female", "male"))
speed$condtn <- factor(x=speed$condtn, levels = c(1,2), labels = c("limited", "extensive"))
speed$match <- factor(x = speed$match, levels = c(0,1), labels = c("no", "yes"))

speed$field_cd <- as.factor(speed$field_cd)
levels(speed$field_cd) <- c("Law","Math","SocScie/Psych", "MedSci", "Engineering", "English", "History", "Business", "Education", "Bio","SocialWork","Undergrad", "PoliSci", "Film","FineArts","Lang","Architecture","Other")

speed$race <- as.factor(speed$race)
levels(speed$race) <- c("Black/African-American", "European/Caucasian-American", "Latino/Hispanic-American", "Asian/Pacific Islander/Asian-American", "Native-American", "Other")

speed$goal <- as.factor(speed$goal)#What is your primary goal in participating in this event? 
levels(speed$goal) <- c("FunNightOut", "MeetNewPpl", "GetADate","SRSRelationship", "ToSayIDidIt","Other")

speed$date <- as.factor(speed$date) #In general, how frequently do you go on dates? 
levels(speed$date) <- c("SVRL/Week","2/Week","1/Week","2/Month", "1/Month", "SVRL/Year", "AlmostNever")

speed$go_out <- as.factor(speed$go_out) #How often do you go out (not necessarily on dates)?
levels(speed$go_out) <- c("SVRL/Week","2/Week","1/Week","2/Month", "1/Month", "SVRL/Year", "AlmostNever")

speed$career_c <-as.factor(speed$career_c) #intended career
levels(speed$career_c) <- c("Lawyer","Academic/Research","Psychologist","DocMed", "Engineer", "Entertainment", "Banking/Consulting", "RealEstate","IntlAffairs","Undecided","SocialWork","SpeechPath","Politics", "ProSports", "Other", "Journalism", "Architecture")

speed$race_o <-as.factor(speed$race_o) #race of partner
levels(speed$race_o) <- c("Black/African-American", "European/Caucasian-American", "Latino/Hispanic-American", "Asian/Pacific Islander/Asian-American", "Native-American")
                       
speed$dec_o <- as.factor(speed$dec_o) #decision of partner the night of event - not sure what this means


speed$samerace <- factor(x = speed$samerace, levels = c(0,1), labels = c("no", "yes"))


```

#Data exploration 

```{r}
#table of males vs. females
ggplot(speed, aes(gender, fill = gender)) + geom_bar(stat="count")

#race by gender
ggplot(speed, aes(race, fill=race)) + geom_histogram(stat ="count") + theme(axis.text=element_text(size=9), axis.text.x = element_text(angle=90, vjust=0.5, hjust=1)) + facet_wrap(~gender)

#look for other race by race & gender


#career by gender
ggplot(speed, aes(career_c, fill=career_c)) + geom_histogram(stat= "count") + facet_wrap(~gender) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + xlab("Career") + ggtitle("Distribution of Career by Gender")


#Income is in factors. problem converting income to factors 

```


#Data Cleaning 
```{r}
sd2 <- speed
sd2 <- sd2[ , -1] #IID  
sd2 <- sd2[, -1] #ID  
sd2 <- sd2[, -2] #IDG
sd2 <- sd2[, -3] #Wave
sd2 <- sd2[, -3] #Round
sd2 <- sd2[, -3] #Position
sd2 <- sd2[, -3] #Postion1
sd2 <- sd2[, -4] #Partner 
sd2 <- sd2[, -4] #PID
sd2 <- sd2[, -26]#Field
sd2 <- sd2[, -(27:29)]#Academics
sd2 <- sd2[,-(30:32)]#Socioeconomic 
sd2 <- sd2[,-33]#Career
sd2 <- sd2[,-(59:64)]#What others look for
sd2 <- sd2[,-(70:74)]#Others perception
sd2 <- sd2[,-(81:92)]#Data gathered after intitial
sd2 <- sd2[,(1:79)]
sd2 <- sd2[,-(70:79)] #Removes Post First Date
sd2 <- sd2[,-52]#exclude expnum

sdrandom <- sd2[sample(nrow(sd2), nrow(sd2)),] #Get a random sample since the data is organized by participant
sdclean <- na.omit(sdrandom) #Remove rows with NA values to create a "clean" set
```

Random Forest 
```{r}
tree_model <- ctree(y ~ ., data = train_data, 
                      control = ctree_control(mincriterion = .99))
tree_random_forest <- randomForest(y~., data = train_data)
```

